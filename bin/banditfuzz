#!/usr/bin/env python3

import  banditfuzz.interface.Settings as settings
from banditfuzz.interface.parseargs import parse
#from banditfuzz.Solver import *
from banditfuzz.fuzz import Fuzzer
def main():
    settings.SaveAllSolve = True
    settings.BugMode = False
    settings.SolverTimeout = 10
    settings.GeneratorMaxDepth = 3
    settings.GeneratorNumConst = 3
    settings.NumPrimaries = 4
    settings.BanditTrainingMode = True
    
    ## Full List of ops
    ## Any subset should work.
    settings.string_ops = ['Concat', 'Contains', 'At', 'Length', 'IndexOf2', 'PrefixOf', 'SuffixOf', 'Replace', 'ReInter', 'ReRange', 'RePlus', 'ReStar', 'ReConcat', 'Str2Re', 'InRegex', 'ToInt', 'Substring']


    ##Database of inputs
    settings.OutputDirectory = 'db/'


    parse()

    fuzzer = Fuzzer(settings.solvers,settings.mutator)
    fuzzer.fuzz()

if __name__ == '__main__':
    main()